<!doctype html>
<html lang="en">
  <head>
  <style>
  html, body, svg {
    width: 100%;
    height: 100%;
  }

  .main-container {
    width: 100%;
    height: 50%;
    overflow: hidden;
    text-align: center;
  }

  .each-pos {
    display: inline-block;
    height: 95%;
    border: 1px solid red;
    overflow: hidden;
    margin-top: 1%;
  }

  .each-nucleotide-in-pos {
    width: 95%;
    border: 1px solid green;
    overflow: hidden;
    text-align: center;
  }
  </style>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  
  <script type="text/javascript">
  var colors = { "A": "red", "C":"blue", "G": "green", "T": "orange"};
  var readSequences = ["AGATCGACCCT","GGAACGACGCT","GGATCGACCCT","CGATAGACGCT","CGATAGACGCT","GGATCGACCCT"];

    var orderedSequences = [];
    var sequences = [];
    var nucletiodesGroupedByIndex = [];

    for (var x = 0; x < readSequences.length; x++) {
      sequences.push(readSequences[x].split(""));
    }

    var nucleotidesPerSequence = sequences[0].length;

    var tempArray;
    for (var x = 0; x < nucleotidesPerSequence; x++) {
      tempArray = [];
      for (var j = 0; j < sequences.length; j++) {
        tempArray.push(sequences[j][x]);
      }
      nucletiodesGroupedByIndex.push(tempArray);
    }

    var tempObj;
    for (var x = 0; x < nucletiodesGroupedByIndex.length; x++) {
      tempObj = {};
      for (var j = 0; j < nucletiodesGroupedByIndex[x].length; j++) {
        if ( !tempObj[ nucletiodesGroupedByIndex[x][j] ] ) tempObj[ nucletiodesGroupedByIndex[x][j] ] = 1;
        else tempObj[ nucletiodesGroupedByIndex[x][j] ]++;
      }
      orderedSequences.push(tempObj);
    }

    function getWidthScaleForText(text) {
      console.log("width");
      console.log(text);
      console.log(text.parentNode.parentNode);
    }

    function getHeightScaleForText(text) {
      console.log("width");
      console.log(text);
      console.log(text.parentNode.parentNode);
    }


  </script>
  </head>
  
  
  <body>
  
  <div class="main-container"><div>

  </body>
  


  <script>
    console.log(orderedSequences);
    var mainSel = d3.select(".main-container").selectAll("p");
    var eachPos = mainSel.data(orderedSequences).enter().append("div").attr("class","each-pos").style("width", Math.floor( (100/ (orderedSequences.length+2))-2 ) + "%");
    var eachNucleotideWithinPos = eachPos.selectAll("p").data( function(d,i) { return d3.entries(d); }  ).enter().append("div").attr("class","each-nucleotide-in-pos").style("height", function(d) { return ( (d.value/readSequences.length*100) + "%" ); } );
    var svgEl = eachNucleotideWithinPos.append("svg");
    var textEl = svgEl.append("text");
    textEl.attr("fill", function(d) {return colors[d.key];} ).text(function(d) { return d.key; });
    textEl.attr("transform","scale("+ textEl.node().parentNode.getBoundingClientRect().width/textEl.node().getBBox().width +","+ textEl.node().parentNode.getBoundingClientRect().height/textEl.node().getBBox().height +")").attr("y", textEl.node().getBBox().height);
    console.log(textEl.node().getBBox());


  </script>
</html>